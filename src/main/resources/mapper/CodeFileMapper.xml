<mapper namespace="com.example.codesimilarity.mapper.CodeFileMapper">
    <resultMap id="codeFileMap" type="com.example.codesimilarity.model.CodeFile">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="path" column="path"/>
        <result property="content" column="content"/>
        <result property="projectId" column="project_id"/>
        <result property="astJson" column="ast_json"/>
    </resultMap>

    <select id="getById" resultMap="codeFileMap" parameterType="java.lang.Integer">
        SELECT * FROM code_file WHERE id = #{id}
    </select>

    <select id="listByProject" resultMap="codeFileMap" parameterType="java.lang.Integer">
        SELECT * FROM code_file WHERE project_id = #{projectId}
    </select>

    <insert id="save" parameterType="com.example.codesimilarity.model.CodeFile">
        INSERT INTO code_file(name, path, content, project_id, ast_json)
        VALUES(#{name}, #{path}, #{content}, #{projectId}, #{astJson})
    </insert>

    <update id="update" parameterType="com.example.codesimilarity.model.CodeFile">
        UPDATE code_file SET name = #{name}, path = #{path}, content = #{content},
        project_id = #{projectId}, ast_json = #{astJson}
        WHERE id = #{id}
    </update>

    <delete id="delete" parameterType="java.lang.Integer">
        DELETE FROM code_file WHERE id = #{id}
    </delete>
</mapper>
